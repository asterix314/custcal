# 客户盈亏计算方法

产品类型|浮动盈亏|利息收入|交易盈亏|费用
--|--|--|--|--
证券买卖|每日：(收盘价-成本价)*持仓数量|入账日：实际发生额|(收盘价-成本价)*持仓数量

### 现金类产品
- 智多鑫：按季度分红，每季度前五个工作日内进行分红。金证中分红流水字段为“基金红利拨入”，红利金额为每季度产品收益。
- 添鑫宝：两种分红方式
  1. 每月第一工作日分配上月收益，以红利转投，即份额形式发放，金证中查询字段为“交易确认份数”
  2. 客户每次全部赎回会带走之前相应产生的收益，金证中查询字段为“交易确认金额”以分红到账作为客户收益
- 信天利：T日申购，T+2日收益到账，以每日基金成交中信天利产品的流水“红利发放”字段对应的交易确认份额作为客户昨日收益。

### 固定收益类
- 平安银行理财：产品结束后，T+1本金及收入到账，金证中查询字段为“金融强行赎回拨入”“成交金额”，客户收益为“成交金额”-“成交数量”
- 兴业银行理财：产品结束后，T+1本金及收入到账，客户收益金额为产品成交数量×产品计息天数/计息基础×产品预期年化收益率
- 资管固收产品：月享、季享、双季享产品结束后，T+3收益分红到账，客户收益为“基金红利拨入”“成交金额”

### 浮动收益类
浮动类产品每日清算后金证中该产品“基金证券市值”减去前一日该产品金证中“基金证券市值”作为客户昨日收益。但该类产品可能会有基金赎回时,资金在途,客户持仓变为零但资金尚未到帐的情况，遂该类资产有赎回操作后收益和资产停止更新，在有赎回到账流水后再进行昨日收益、累计收益和理财资产的更新。此外，权益类产品偶尔会出现分红情况，净值和份额可能会出现变动不同步的情况，所以在产品分红当天停止更新收益和资产，在金证中出现“强行调增份额”这条流水后，再更新收益和资产。

### 固定收益
- 深圳报价回购：客户投资收益=产品收益率*购买产品规模/360天*产品对应期限（遇到节假日顺延）
- 收益凭证客户：投资收益=持有份额*份额面值*投资收益率*投资天数/365
- 衍生品：终止前一个工作日，衍生品部算完收益，提供给信息技术部，收益更新在终止日

### 公募基金部分
总的原则：凡是当日有份额变动的客户账户，从清算份额变动数据到确认日净值公布之前，不变动资产和盈利。

#### 基金认购
1. 申请到清算“认购成立”数据之前资产：不变化，按照“委托金额”增加资产盈亏：不变化份额：没有
2. 清算“认购成立”数据资产：按照“认购成立”数据文件里的“确认份额”字段*行情文件中的基金净值来增加资产；同时调减委托金额当日盈亏：确认份额*基金净值-确认金额
3. 之后资产：基金份额*基金净值当日盈亏：当日该基金资产-前日该基金资产

### 基金申购（含定时定额申购）
1. 申请到清算“申购确认”数据之前资产：不变化，按照“委托金额”增加资产盈亏：不变化份额：没有
2. 清算“申购确认”数据资产：按照“申购确认”数据文件里的“确认份额”字段*行情文件中的基金净值，来增加资产；同时调减委托金额当日盈亏：确认份额*基金净值-确认金额
3. 之后资产：基金份额*基金净值当日盈亏：当日该基金资产-前日该基金资产

### 基金赎回
1. 申请到清算“赎回确认”数据之前资产：不变化盈亏：不变化
2. 清算“赎回确认”数据资产：按照“赎回确认”数据文件里的“赎回份额”字段*行情文件中的基金净值，来减少资产变动部分当日盈亏：确认份额*基金净值（今日-昨日）-赎回费
3. 之后资产：基金份额*基金净值当日盈亏：当日该基金资产-前日该基金资产

### 基金转换
有一笔基金转换确认模式有两笔确认模式，分别找到数据中的起始和目标基金份额和代码，进行以下计算
1. 申请到清算“转换确认”数据之前资产：不变化盈亏：不变化
2. 清算“转换确认”数据资产：按照“转换确认”相关数据文件里的转换出份额*行情文件中的基金净值，来减少资产，按照转换入份额*转入基金的净值，来增加资产当日盈亏：转入份额*转入基金的净值-转出基金份额*转出基金的净值
3. 之后资产：基金份额*基金净值当日盈亏：当日该基金资产-前日该基金资产

### 基金分红
1. 申请到清算“红利发放”数据之前资产：不变化盈亏：不变化
2. 清算“红利发放”数据现金分红资产：不变化盈亏：增加“交易确认金额”字段对应的金额份额分红资产：不变化当日盈亏：当日该基金资产-前日该基金资产
3. 之后资产：基金份额*基金净值当日盈亏：当日该基金资产-前日该基金资产
