(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     41355,        957]
NotebookOptionsPosition[     39876,        901]
NotebookOutlinePosition[     40230,        917]
CellTagsIndexPosition[     40187,        914]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6803831606672993`*^9, 3.6803831987383747`*^9}, {
  3.680383960937335*^9, 3.6803839697359037`*^9}}],

Cell[BoxData["\<\"C:\\\\cygwin64\\\\home\\\\zhangchenhui\\\\custcal\"\>"], \
"Output",
 CellChangeTimes->{
  3.680383970703122*^9, 3.680405672205435*^9, {3.680490290495*^9, 
   3.680490305727*^9}, 3.6805583433059998`*^9, 3.6808357585136285`*^9, 
   3.680845232976194*^9, 3.6808470187554502`*^9, 3.6809037208224754`*^9, {
   3.6809185896276426`*^9, 3.6809186045567474`*^9}, {3.6809187435218525`*^9, 
   3.680918771077672*^9}, 3.680918810371016*^9, 3.6809188483463683`*^9, 
   3.6809189711243773`*^9, 3.6809238008312016`*^9, 3.6809453557919793`*^9, 
   3.6809873706325626`*^9, 3.6822998598717813`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:51fd\:6570\:5b9a\:4e49", "Section",
 CellChangeTimes->{{3.680926869674283*^9, 3.680926885617381*^9}, {
  3.680996372468839*^9, 3.680996373997629*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\:6838\:7b97\:8bbe\:8ba1", "=", 
    RowBox[{"<|", 
     RowBox[{"\"\<\:6838\:7b97\:8bbe\:8ba1\:6587\:672c\>\"", "->", 
      RowBox[{"Import", "[", 
       RowBox[{"\"\<custcal.org\>\"", ",", "\"\<Text\>\"", ",", 
        RowBox[{"CharacterEncoding", "\[Rule]", "\"\<UTF8\>\""}]}], "]"}]}], 
     "|>"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"\:6838\:7b97\:8bbe\:8ba1", ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<\:4f1a\:8ba1\:5206\:5f55\:6587\:672c\>\"", "->", 
      RowBox[{
       RowBox[{"Query", "[", 
        RowBox[{
        "\"\<\:6838\:7b97\:8bbe\:8ba1\:6587\:672c\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Association", "@", 
          RowBox[{"StringCases", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"StringExpression", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "StartOfLine", "~~", 
               "\"\<#+NAME: acc:\:4f1a\:8ba1\:5206\:5f55\>\"", "~~", 
               "Whitespace"}], ",", "\[IndentingNewLine]", 
              RowBox[{"tcnt", ":", 
               RowBox[{"Shortest", "[", 
                RowBox[{"\"\<|-\>\"", "~~", "__", "~~", "\"\<-|\\n\>\""}], 
                "]"}]}], ",", "\[IndentingNewLine]", "\"\<\\n\>\""}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"StringTrim", "@", 
               RowBox[{"First", "@", 
                RowBox[{"StringSplit", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"StringSplit", "[", 
                    RowBox[{"tcnt", ",", "\"\<\\n\>\""}], "]"}], "[", 
                   RowBox[{"[", "4", "]"}], "]"}], ",", "\"\<|\>\""}], 
                 "]"}]}]}], "\[Rule]", "tcnt"}], ")"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], "@", "\:6838\:7b97\:8bbe\:8ba1"}]}]}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AssociateTo", "[", 
    RowBox[{"\:6838\:7b97\:8bbe\:8ba1", ",", 
     RowBox[{"(*", " ", "\:5404\:8868\:683c\:9879\:5185\:5bb9", " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RightComposition", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"StringCases", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"StringExpression", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"StartOfLine", "~~", "\"\<#+NAME: \>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"type", ":", 
              RowBox[{"(", 
               RowBox[{"WordCharacter", ".."}], ")"}]}], "~~", "\"\<:\>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"tname", ":", 
               RowBox[{"LetterCharacter", ".."}]}], ")"}], "~~", 
             "Whitespace"}], ",", "\[IndentingNewLine]", 
            RowBox[{"tcnt", ":", 
             RowBox[{"Shortest", "[", 
              RowBox[{"\"\<|-\>\"", "~~", "__", "~~", "\"\<-|\\n\>\""}], 
              "]"}]}], ",", "\[IndentingNewLine]", "\"\<\\n\>\""}], "]"}], 
          "\[RuleDelayed]", "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{"tname", "\[Rule]", "\[IndentingNewLine]", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"tb", "=", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{"StringTrim", "@*", "ToString"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ImportString", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"tcnt", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"StartOfLine", "~~", "\"\<|\>\"", "~~", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    "\"\<+\>\"", "|", "\"\<-\>\"", "|", "\"\<|\>\"", "|", 
                    "\"\< \>\""}], ")"}], ".."}], "~~", "\"\<|\\n\>\""}], 
                    "\[Rule]", "\"\<\>\""}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "\"\<Table\>\"", ",", 
                    RowBox[{"\"\<FieldSeparators\>\"", "\[Rule]", 
                    RowBox[{"{", "\"\<|\>\"", "}"}]}], ",", 
                    RowBox[{"\"\<LineSeparators\>\"", "\[Rule]", 
                    RowBox[{"{", "\"\<|\\n\>\"", "}"}]}]}], "]"}], ",", 
                  RowBox[{"{", "2", "}"}]}], "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Switch", "[", 
               RowBox[{"type", ",", "\[IndentingNewLine]", "\"\<tab\>\"", ",", 
                RowBox[{"AssociationThread", "[", 
                 RowBox[{
                  RowBox[{"tb", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", ";;"}], ",", "1"}], "]"}], "]"}], "\[Rule]", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"AssociationThread", "[", 
                    RowBox[{
                    RowBox[{"Rest", "@", 
                    RowBox[{"First", "@", "tb"}]}], "\[Rule]", "#"}], "]"}], 
                    "&"}], ",", 
                    RowBox[{"tb", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", ";;"}], ",", 
                    RowBox[{"2", ";;"}]}], "]"}], "]"}]}], "]"}]}], "]"}], 
                ",", "\[IndentingNewLine]", "_", ",", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"AssociationThread", "[", 
                    RowBox[{
                    RowBox[{"First", "[", "tb", "]"}], "\[Rule]", "#"}], 
                    "]"}], "&"}], ",", 
                  RowBox[{"Rest", "[", "tb", "]"}]}], "]"}]}], "]"}]}], 
             "]"}]}], ")"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Merge", "[", 
         RowBox[{"Apply", "@", "Join"}], "]"}]}], "\[IndentingNewLine]", 
       "]"}], "@", 
      RowBox[{
      "\:6838\:7b97\:8bbe\:8ba1", "[", 
       "\"\<\:6838\:7b97\:8bbe\:8ba1\:6587\:672c\>\"", "]"}]}]}], "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"\:6838\:7b97\:8bbe\:8ba1", ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<\:6570\:636e\:5b57\:5178\>\"", "\[Rule]", 
      RowBox[{"Normal", "@", 
       RowBox[{
        RowBox[{"KeyMap", "[", 
         RowBox[{
          RowBox[{"WordBoundary", "~~", "#", "~~", "WordBoundary"}], "&"}], 
         "]"}], "@", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Query", "[", 
            RowBox[{
            "\"\<\:6838\:7b97\:8f93\:5165\:8f93\:51fa\>\"", ",", "All", ",", 
             "\"\<\:6570\:636e\:5e93\:8868\>\""}], "]"}], "@", 
           "\:6838\:7b97\:8bbe\:8ba1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Association", "@", 
           RowBox[{
            RowBox[{"Query", "[", 
             RowBox[{
             "\"\<\:8868\:5b57\:6bb5\:5b9a\:4e49\>\"", ",", "All", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#\:53d8\:91cf\:540d\:79f0", "\[Rule]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Query", "[", 
                    RowBox[{
                    "\"\<\:6838\:7b97\:8f93\:5165\:8f93\:51fa\>\"", ",", 
                    "#\:8868", ",", "\"\<\:6570\:636e\:5e93\:8868\>\""}], 
                    "]"}], "[", "\:6838\:7b97\:8bbe\:8ba1", "]"}], "<>", 
                  "\"\<.\>\"", "<>", "#\:5b57\:6bb5"}]}], ")"}], "&"}]}], 
             "]"}], "@", "\:6838\:7b97\:8bbe\:8ba1"}]}]}], "]"}]}]}]}]}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"\:6838\:7b97\:8bbe\:8ba1", ",", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"\:501f\:65b9\:4f59\:989d", " ", "=", " ", "1"}], "\:ff0c", 
       RowBox[{"\:8d37\:65b9\:4f59\:989d", " ", "=", " ", 
        RowBox[{"-", "1"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\"\<\:79d1\:76ee\:4fe1\:606f\>\"", "->", 
      RowBox[{"Association", "@", 
       RowBox[{
        RowBox[{"Query", "[", 
         RowBox[{
         "\"\<\:8868\:5b57\:6bb5\:5b9a\:4e49\>\"", ",", "\[IndentingNewLine]", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"StringMatchQ", "[", 
             RowBox[{"#\:7c7b\:578b", ",", "\"\<\:8868*\:65b9\>\""}], "]"}], 
            "&"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"#\:53d8\:91cf\:540d\:79f0", "\[Rule]", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<\:79d1\:76ee\:65b9\:5411\>\"", "->", 
               RowBox[{
                RowBox[{"2", 
                 RowBox[{"Boole", "@", 
                  RowBox[{"StringMatchQ", "[", 
                   RowBox[{"#\:7c7b\:578b", ",", "\"\<*\:501f\:65b9\>\""}], 
                   "]"}]}]}], "-", "1"}]}], ",", 
              RowBox[{"\"\<\:8868\>\"", "\[Rule]", "#\:8868"}]}], "|>"}]}], 
           "&"}]}], "\[IndentingNewLine]", "]"}], "@", 
        "\:6838\:7b97\:8bbe\:8ba1"}]}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"\:6838\:7b97\:8bbe\:8ba1", ",", 
    RowBox[{
    "(*", " ", 
     "\:4e0d\:540c\:4e1a\:52a1\:4e0b\:5404\:79d1\:76ee\:7684\:53d1\:751f\:989d\
", " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"\"\<\:4e1a\:52a1\:6838\:7b97\>\"", "->", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"KeyDrop", "[", "\"\<\:8868\:5916\:5bf9\:62c6\>\"", "]"}], 
       "]"}], "@", 
      RowBox[{
       RowBox[{"Query", "[", "\[IndentingNewLine]", 
        RowBox[{
        "\"\<\:4f1a\:8ba1\:5206\:5f55\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{"e", "\[Function]", 
           RowBox[{"GroupBy", "[", 
            RowBox[{"e", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Key", "[", "\"\<\:6838\:7b97\:7c7b\:578b\>\"", "]"}], 
              "\[Rule]", 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"<|", 
                 RowBox[{
                  RowBox[{"#\:501f\:65b9", "\[Rule]", 
                   RowBox[{
                    RowBox[{"\:6838\:7b97\:8bbe\:8ba1", "[", 
                    RowBox[{
                    "\"\<\:79d1\:76ee\:4fe1\:606f\>\"", ",", "#\:501f\:65b9", 
                    ",", "\"\<\:79d1\:76ee\:65b9\:5411\>\""}], "]"}], 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#\:91d1\:989d", ",", 
                    RowBox[{"\"\<.\>\"", "\[Rule]", "\"\<$\>\""}]}], "]"}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"#\:8d37\:65b9", "\[Rule]", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\:6838\:7b97\:8bbe\:8ba1", "[", 
                    RowBox[{
                    "\"\<\:79d1\:76ee\:4fe1\:606f\>\"", ",", "#\:8d37\:65b9", 
                    ",", "\"\<\:79d1\:76ee\:65b9\:5411\>\""}], "]"}]}], 
                    RowBox[{"ToExpression", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#\:91d1\:989d", ",", 
                    RowBox[{"\"\<.\>\"", "\[Rule]", "\"\<$\>\""}]}], "]"}], 
                    "]"}]}]}]}], "|>"}], "&"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Merge", "[", 
              RowBox[{"Total", "/*", "InputForm", "/*", "ToString"}], "]"}]}],
             "]"}]}], ")"}]}], "\[IndentingNewLine]", "]"}], "@", 
       "\:6838\:7b97\:8bbe\:8ba1"}]}]}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.6809090295726013`*^9, {3.6809267343880157`*^9, 3.680926763592963*^9}, {
   3.680927057549879*^9, 3.6809270618710513`*^9}, {3.680927685301446*^9, 
   3.6809278210419493`*^9}, {3.680936231557029*^9, 3.6809362392634287`*^9}, {
   3.6809367375724125`*^9, 3.6809367382432084`*^9}, {3.680939196629846*^9, 
   3.6809392180651083`*^9}, {3.680940498894689*^9, 3.68094050504105*^9}, 
   3.6809453653703175`*^9, {3.6809467014731154`*^9, 3.680946737276886*^9}, {
   3.6809468041076536`*^9, 3.6809468110028095`*^9}, {3.6809477535171638`*^9, 
   3.680947762377907*^9}, 3.6809883273689013`*^9, {3.680990384315134*^9, 
   3.680990412629346*^9}, {3.6809907611975174`*^9, 3.6809907779987173`*^9}, {
   3.6809909991287174`*^9, 3.680991005852318*^9}, {3.6809929894495945`*^9, 
   3.6809931139843946`*^9}, {3.680993189924219*^9, 3.680993192576151*^9}, {
   3.6809932768919888`*^9, 3.6809933006969786`*^9}, {3.680993781779579*^9, 
   3.6809937880663795`*^9}, {3.680993856706379*^9, 3.680993887999979*^9}, {
   3.6809944689715385`*^9, 3.6809944961153326`*^9}, {3.680994527284133*^9, 
   3.6809945529149327`*^9}, {3.6809956977541327`*^9, 3.680995699251733*^9}, {
   3.682299925780466*^9, 3.6822999267692566`*^9}, {3.682301082104323*^9, 
   3.6823010867248607`*^9}, {3.682301380163514*^9, 3.6823013897865515`*^9}, {
   3.682301448142*^9, 3.6823014929449997`*^9}, {3.682301539899*^9, 
   3.682301542682*^9}, {3.682303141988*^9, 3.6823031435769997`*^9}, {
   3.682303271731*^9, 3.6823032754960003`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:5b58\:50a8\:8fc7\:7a0b\:751f\:6210", "Section",
 CellChangeTimes->{{3.680926869674283*^9, 3.680926885617381*^9}, {
  3.680996372468839*^9, 3.6809963898627276`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Query", "[", "\[IndentingNewLine]", 
   RowBox[{"\"\<\:6838\:7b97\:529e\:6cd5\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"#\:6a21\:677f", "\[Equal]", "\"\<Y\>\""}], "&"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<sp\>\"", ",", 
          RowBox[{"#\:5b58\:50a8\:8fc7\:7a0b", "<>", "\"\<.sql\>\""}]}], 
         "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TemplateApply", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<templates\>\"", ",", 
              RowBox[{
              "#\:6838\:7b97\:7c7b\:578b", "<>", "\"\<.template\>\""}]}], 
             "}"}], "]"}], ",", "\"\<Text\>\"", ",", 
           RowBox[{"CharacterEncoding", "\[Rule]", "\"\<UTF8\>\""}]}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Query", "[", 
             RowBox[{
             "\"\<\:6838\:7b97\:8f93\:5165\:8f93\:51fa\>\"", ",", "All", ",", 
              "\"\<\:6570\:636e\:5e93\:8868\>\""}], "]"}], "@", 
            "\:6838\:7b97\:8bbe\:8ba1"}], ",", "\[IndentingNewLine]", "#"}], 
          "\[IndentingNewLine]", "]"}]}], "]"}], ",", "\"\<Text\>\"", ",", 
       RowBox[{"CharacterEncoding", "\[Rule]", "\"\<CP936\>\""}]}], "]"}], 
     "&"}]}], "]"}], "@", "\:6838\:7b97\:8bbe\:8ba1"}]], "Input",
 CellChangeTimes->{{3.682302338401*^9, 3.682302339403*^9}, {3.682303346692*^9,
    3.6823033639449997`*^9}, {3.682303403801*^9, 3.682303415391*^9}, {
   3.682303466076*^9, 3.6823034963129997`*^9}, {3.682303559692*^9, 
   3.682303579573*^9}, {3.682304262597*^9, 3.682304304426*^9}, {
   3.682304338135*^9, 3.6823044065179996`*^9}, {3.682304439197*^9, 
   3.682304485362*^9}, 3.682304560851*^9, {3.682304696119*^9, 
   3.682304697094*^9}, {3.68230480658*^9, 3.682304807278*^9}, 
   3.6823048511140003`*^9, {3.682304930259*^9, 3.68230493285*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"sp\\\\sp_Cust_PT_Hltax.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_ZJCQ_Gxhlkslb.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_PT_Zdjy.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_PT_Cxzd.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_HG_Zdjy.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_HG_Czjy.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_ZJCQ_Tzxjc.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_ZJCQ_Tzxjq.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_PT_Scgqzq.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_PT_Tpqr.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_ZZCQ_Sfcgxjlb.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_ZZCQ_Sfcgxjhc.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_QZCQ_Xjlb.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_QZCQ_Xjhc.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_QZCQ_Zplb.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_QZCQ_Zphc.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_PT_Zqlb.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_PT_Zqhc.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_CG_Yzzr.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_ZJCQ_Czc.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_ZJCQ_Xjc.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_ZZCQ_Yzzztzc.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_ZJCQ_Zzzpc.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_ZJCQ_Otcr.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_ZZCQ_Tzzzr.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_CG_Yzzc.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_ZJCQ_Czq.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_ZJCQ_Xjq.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_ZJCQ_Zzzpq.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_ZJCQ_Otcc.sql\"\>", 
   ",", "\<\"sp\\\\sp_Cust_ZZCQ_Tzzzc.sql\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.682304936507*^9, 3.682311139329*^9, 3.682311183049*^9, 
  3.6823113489440002`*^9, 3.68231291727*^9, 3.682316613348*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:8349\:7a3f", "Section",
 CellChangeTimes->{{3.680176209981593*^9, 3.680176212328283*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"\:6620\:5c04\:5b57\:6bb5", ",", " ", "\:5b58\:50a8\:8fc7\:7a0b"}],
    "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "\:6620\:5c04\:5b57\:6bb5", "[", "\:4e2d\:6587\:5b57\:6bb5_List", "]"}], ":=", 
   RowBox[{"StringRiffle", "[", 
    RowBox[{
     RowBox[{"StringReplace", "[", 
      RowBox[{"\:4e2d\:6587\:5b57\:6bb5", ",", 
       RowBox[{
       "\:6838\:7b97\:8bbe\:8ba1", "[", "\"\<\:6570\:636e\:5b57\:5178\>\"", 
        "]"}]}], "]"}], ",", "\"\<, \>\""}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "\:5b58\:50a8\:8fc7\:7a0b", "[", "\:4e1a\:52a1\:7c7b\:578b_String", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\:6301\:4ed3\:6838\:7b97\:5b57\:6bb5", ",", 
      "\:8d44\:91d1\:6838\:7b97\:5b57\:6bb5"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\:6301\:4ed3\:6838\:7b97\:5b57\:6bb5", ",", 
        "\:8d44\:91d1\:6838\:7b97\:5b57\:6bb5"}], "}"}], "=", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"t", "\[Function]", 
         RowBox[{
          RowBox[{"Query", "[", 
           RowBox[{
           "\"\<\:4e1a\:52a1\:6838\:7b97\>\"", ",", 
            "\:4e1a\:52a1\:7c7b\:578b", ",", 
            RowBox[{"KeySelect", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\:6838\:7b97\:8bbe\:8ba1", "[", 
                RowBox[{
                "\"\<\:79d1\:76ee\:4fe1\:606f\>\"", ",", "#", ",", 
                 "\"\<\:8868\>\""}], "]"}], "\[Equal]", "t"}], "&"}], "]"}]}],
            "]"}], "@", "\:6838\:7b97\:8bbe\:8ba1"}]}], "]"}], "@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\:6301\:4ed3\:6838\:7b97\>\"", ",", 
         "\"\<\:8d44\:91d1\:6838\:7b97\>\""}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"TemplateApply", "[", 
      RowBox[{
       RowBox[{
       "\:6838\:7b97\:8bbe\:8ba1", "[", 
        "\"\<\:5b58\:50a8\:8fc7\:7a0b\:6a21\:677f\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Query", "[", 
           RowBox[{
           "\"\<\:6838\:7b97\:8f93\:5165\:8f93\:51fa\>\"", ",", "All", ",", 
            "\"\<\:6570\:636e\:5e93\:8868\>\""}], "]"}], "@", 
          "\:6838\:7b97\:8bbe\:8ba1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Query", "[", 
           RowBox[{
           "\"\<\:6838\:7b97\:529e\:6cd5\>\"", ",", 
            "\:4e1a\:52a1\:7c7b\:578b"}], "]"}], "@", 
          "\:6838\:7b97\:8bbe\:8ba1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"<|", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<\:4f1a\:8ba1\:5206\:5f55\>\"", "\[Rule]", 
            RowBox[{"\:6838\:7b97\:8bbe\:8ba1", "[", 
             RowBox[{
             "\"\<\:4f1a\:8ba1\:5206\:5f55\:6587\:672c\>\"", ",", 
              "\:4e1a\:52a1\:7c7b\:578b"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
           "\"\<\:4e1a\:52a1\:7c7b\:578b\>\"", " ", "\[Rule]", " ", 
            "\:4e1a\:52a1\:7c7b\:578b"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{"\"\<\:6d41\:901a\:7c7b\:578b\>\"", " ", "\[Rule]", 
            RowBox[{"\"\<'\>\"", "<>", 
             RowBox[{"StringTake", "[", 
              RowBox[{
               RowBox[{"\"\<0\>\"", "<>", 
                RowBox[{"\:6838\:7b97\:8bbe\:8ba1", "[", 
                 RowBox[{
                 "\"\<\:6838\:7b97\:529e\:6cd5\>\"", ",", 
                  "\:4e1a\:52a1\:7c7b\:578b", ",", 
                  "\"\<\:6d41\:901a\:7c7b\:578b\>\""}], "]"}]}], ",", 
               RowBox[{"-", "2"}]}], "]"}], "<>", "\"\<'\>\""}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<\:6301\:4ed3\:6838\:7b97\:5b57\:6bb5\>\"", "\[Rule]", 
            RowBox[{"\"\<, \>\"", "<>", 
             RowBox[{"\:6620\:5c04\:5b57\:6bb5", "[", 
              RowBox[{"Keys", "@", "\:6301\:4ed3\:6838\:7b97\:5b57\:6bb5"}], 
              "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<\:6301\:4ed3\:6838\:7b97\:53d1\:751f\:989d\>\"", "\[Rule]", 
            RowBox[{"\"\<, \>\"", "<>", 
             RowBox[{"\:6620\:5c04\:5b57\:6bb5", "[", 
              RowBox[{"Values", "@", "\:6301\:4ed3\:6838\:7b97\:5b57\:6bb5"}],
               "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<\:8d44\:91d1\:6838\:7b97\:5b57\:6bb5\>\"", "->", 
            RowBox[{"\"\<, \>\"", "<>", 
             RowBox[{"\:6620\:5c04\:5b57\:6bb5", "[", 
              RowBox[{"Keys", "@", "\:8d44\:91d1\:6838\:7b97\:5b57\:6bb5"}], 
              "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<\:8d44\:91d1\:6838\:7b97\:53d1\:751f\:989d\>\"", "->", 
            RowBox[{"\"\<, \>\"", "<>", 
             RowBox[{"\:6620\:5c04\:5b57\:6bb5", "[", 
              RowBox[{"Values", "@", "\:8d44\:91d1\:6838\:7b97\:5b57\:6bb5"}],
               "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<\:6301\:4ed3\:6838\:7b97\:66f4\:65b0\>\"", "\[Rule]", 
            RowBox[{"\:6620\:5c04\:5b57\:6bb5", "[", 
             RowBox[{"KeyValueMap", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", "<>", "\"\< = \>\"", "<>", "#2"}], "&"}], ",", 
               "\:6301\:4ed3\:6838\:7b97\:5b57\:6bb5"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<\:8d44\:91d1\:6838\:7b97\:66f4\:65b0\>\"", "\[Rule]", 
            RowBox[{"\:6620\:5c04\:5b57\:6bb5", "[", 
             RowBox[{"KeyValueMap", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", "<>", "\"\< = \>\"", "<>", "#2"}], "&"}], ",", 
               "\:8d44\:91d1\:6838\:7b97\:5b57\:6bb5"}], "]"}], "]"}]}]}], 
          "\[IndentingNewLine]", "|>"}]}], "]"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6809426186200824`*^9, 3.6809426682443647`*^9}, {
   3.6809428097228575`*^9, 3.680942822687374*^9}, {3.680942874246044*^9, 
   3.6809429106250105`*^9}, 3.680942960857689*^9, {3.680944023812952*^9, 
   3.680944032361752*^9}, {3.680944325227552*^9, 3.680944335975952*^9}, {
   3.6809444633549037`*^9, 3.68094448734755*^9}, {3.6809446449631357`*^9, 
   3.6809446647916083`*^9}, {3.680944725289421*^9, 3.6809447663669577`*^9}, {
   3.68094481117187*^9, 3.6809448655541215`*^9}, {3.680945037733218*^9, 
   3.680945103551196*^9}, 3.6809909756195173`*^9, {3.6809910571451178`*^9, 
   3.680991058315118*^9}, {3.6809911475315175`*^9, 3.6809911494503174`*^9}, {
   3.6809962230373325`*^9, 3.680996279587034*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"\:6838\:7b97\:8bbe\:8ba1", ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<\:5b58\:50a8\:8fc7\:7a0b\:6a21\:677f\>\"", "\[Rule]", 
      "\[IndentingNewLine]", 
      RowBox[{"Import", "[", 
       RowBox[{"\"\<sp.template\>\"", ",", "\"\<Text\>\"", ",", 
        RowBox[{"CharacterEncoding", "\[Rule]", "\"\<UTF8\>\""}]}], "]"}]}]}],
     "]"}], ";"}], "\[IndentingNewLine]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<test.sql\>\"", ",", 
   RowBox[{"TemplateApply", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{"\"\<tpl_merge.sql\>\"", ",", "\"\<Text\>\"", ",", 
       RowBox[{"CharacterEncoding", "\[Rule]", "\"\<UTF8\>\""}]}], "]"}], ",",
      " ", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{
       "\"\<\:4e1a\:52a1\:6d41\:6c34\:8868\>\"", "\[Rule]", 
        "\"\<logasset_hs\>\""}], ",", 
       RowBox[{
       "\"\<\:6301\:4ed3\:6838\:7b97\:8868\>\"", "\[Rule]", 
        "\"\<stkasset_hs\>\""}], ",", " ", 
       RowBox[{
       "\"\<\:4e1a\:52a1\:7c7b\:578b\>\"", " ", "\[Rule]", " ", 
        "\"\<\:7ea2\:5229\:5165\:8d26\>\""}], ",", " ", 
       RowBox[{
       "\"\<\:4e1a\:52a1\:6458\:8981\>\"", " ", "\[Rule]", " ", 
        "\"\<221007\>\""}], ",", 
       RowBox[{"\"\<\:4f1a\:8ba1\:5206\:5f55\>\"", "\[Rule]", 
        RowBox[{"\:6838\:7b97\:8bbe\:8ba1", "[", 
         RowBox[{
         "\"\<\:4f1a\:8ba1\:5206\:5f55\:6587\:672c\>\"", ",", 
          "\"\<\:7ea2\:5229\:5165\:8d26\>\""}], "]"}]}]}], "|>"}]}], "]"}], 
   ",", "\"\<Text\>\"", ",", 
   RowBox[{"CharacterEncoding", "\[Rule]", "\"\<UTF8\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6808358553620286`*^9, 3.680835923281829*^9}, {
   3.680836172715029*^9, 3.6808361773804283`*^9}, {3.6808362508690286`*^9, 
   3.6808362512402287`*^9}, {3.6808362997560287`*^9, 
   3.6808363157704287`*^9}, {3.6808376144111357`*^9, 3.6808376300663357`*^9}, 
   3.6808376827391357`*^9, {3.680837866549336*^9, 3.6808379130197363`*^9}, {
   3.680837962349736*^9, 3.680837996359536*^9}, {3.680838040418536*^9, 
   3.680838094021736*^9}, {3.680838157625136*^9, 3.680838158495336*^9}, {
   3.6808495578822317`*^9, 3.6808495760073338`*^9}, {3.6808502989238806`*^9, 
   3.6808503025074806`*^9}, {3.680850360163881*^9, 3.6808503795650806`*^9}, {
   3.6809092396982718`*^9, 3.68090924952602*^9}, {3.680909564330032*^9, 
   3.6809096090606585`*^9}}],

Cell[BoxData[
 RowBox[{"Nest", "[", 
  RowBox[{
   RowBox[{"t", "\[Function]", 
    RowBox[{"TemplateApply", "[", 
     RowBox[{"t", ",", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{
        "\"\<\:4e1a\:52a1\:6d41\:6c34\:8868\>\"", "\[Rule]", 
         "\"\<logasset_hs\>\""}], ",", 
        RowBox[{
        "\"\<\:6301\:4ed3\:6838\:7b97\:8868\>\"", "\[Rule]", 
         "\"\<stkasset_hs\>\""}], ",", " ", 
        RowBox[{
        "\"\<\:4e1a\:52a1\:7c7b\:578b\>\"", " ", "\[Rule]", " ", 
         "\"\<\:7ea2\:5229\:5165\:8d26\>\""}], ",", " ", 
        RowBox[{
        "\"\<\:4e1a\:52a1\:6458\:8981\>\"", " ", "\[Rule]", " ", 
         "\"\<221007\>\""}], ",", 
        RowBox[{"\"\<\:4f1a\:8ba1\:5206\:5f55\>\"", "\[Rule]", 
         RowBox[{"\:6838\:7b97\:8bbe\:8ba1", "[", 
          RowBox[{
          "\"\<\:4f1a\:8ba1\:5206\:5f55\:6587\:672c\>\"", ",", 
           "\"\<\:7ea2\:5229\:5165\:8d26\>\""}], "]"}]}]}], "|>"}]}], "]"}]}],
    ",", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<tpl_merge.sql\>\"", ",", "\"\<Text\>\"", ",", 
     RowBox[{"CharacterEncoding", "\[Rule]", "\"\<UTF8\>\""}]}], "]"}], ",", 
   "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.680911613253171*^9, 3.680911634359971*^9}, {
  3.680911690341771*^9, 3.6809116957705708`*^9}, {3.6809117471473713`*^9, 
  3.680911766651371*^9}, {3.680911815607171*^9, 3.6809118223931713`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Intersection", "[", 
  RowBox[{
   RowBox[{"Keys", "@", 
    RowBox[{"\:6838\:7b97\:8bbe\:8ba1", "[", 
     RowBox[{
     "\"\<\:4e1a\:52a1\:6838\:7b97\>\"", ",", 
      "\"\<\:7ea2\:5229\:5165\:8d26\>\""}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"Query", "[", 
     RowBox[{"\"\<\:8868\:5b57\:6bb5\:5b9a\:4e49\>\"", ",", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#\:8868", "\[Equal]", "\"\<\:8d44\:91d1\:6838\:7b97\>\""}],
           "&&", 
          RowBox[{"StringMatchQ", "[", 
           RowBox[{"#\:7c7b\:578b", ",", "\"\<\:8868*\:65b9\>\""}], "]"}]}], 
         "&"}], "]"}], "/*", "Keys"}]}], "]"}], "@", 
    "\:6838\:7b97\:8bbe\:8ba1"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6809102279482102`*^9, 3.6809102279482102`*^9}, 
   3.680918580809699*^9, {3.6809186392373247`*^9, 3.6809186431840997`*^9}, {
   3.680919050003472*^9, 3.6809190574134245`*^9}, {3.6809197275796194`*^9, 
   3.6809197889228196`*^9}}],

Cell[BoxData[
 RowBox[{"{", "\<\"\:8d26\:6237\:8d44\:91d1\"\>", "}"}]], "Output",
 CellChangeTimes->{
  3.6809101941998425`*^9, 3.680910229211794*^9, {3.680918644057694*^9, 
   3.6809186535112333`*^9}, {3.680919035027568*^9, 3.6809190586302166`*^9}, 
   3.68091973009122*^9, {3.6809197700468197`*^9, 3.6809197902332196`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\:6838\:7b97\:8bbe\:8ba1", "[", 
  RowBox[{
  "\"\<\:4e1a\:52a1\:6838\:7b97\>\"", ",", 
   "\"\<\:7ea2\:5229\:5165\:8d26\>\""}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"\:8d26\:6237\:8d44\:91d1\"\>", "\[Rule]", 
    "\:6210\:4ea4\:91d1\:989d"}], ",", 
   RowBox[{"\<\"\:5229\:606f\:6536\:5165\"\>", "\[Rule]", 
    "\:6210\:4ea4\:91d1\:989d"}], ",", 
   RowBox[{"\<\"\:8868\:5916\:5bf9\:62c6\"\>", "\[Rule]", 
    "\:6210\:4ea4\:91d1\:989d"}], ",", 
   RowBox[{"\<\"\:7ea2\:5229\:91d1\:989d\"\>", "\[Rule]", 
    "\:6210\:4ea4\:91d1\:989d"}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.6809199134225836`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TemplateApply", "[", 
  RowBox[{
   RowBox[{"\:6838\:7b97\:8bbe\:8ba1", "[", 
    RowBox[{
    "\"\<\:5b58\:50a8\:8fc7\:7a0b\:6a21\:677f\>\"", ",", 
     "\"\<\:4f1a\:8ba1\:6838\:7b97\>\""}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{
     "\"\<\:4e1a\:52a1\:6d41\:6c34\:8868\>\"", "\[Rule]", 
      "\"\<logasset_hs\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<\:6301\:4ed3\:6838\:7b97\:8868\>\"", "\[Rule]", 
      "\"\<stkasset_hs\>\""}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<\:4e1a\:52a1\:7c7b\:578b\>\"", " ", "\[Rule]", " ", 
      "\"\<\:7ea2\:5229\:5165\:8d26\>\""}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<\:4e1a\:52a1\:6458\:8981\>\"", " ", "\[Rule]", " ", 
      "\"\<221007\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<\:4f1a\:8ba1\:5206\:5f55\>\"", "\[Rule]", 
      RowBox[{"\:6838\:7b97\:8bbe\:8ba1", "[", 
       RowBox[{
       "\"\<\:4f1a\:8ba1\:5206\:5f55\:6587\:672c\>\"", ",", 
        "\"\<\:7ea2\:5229\:5165\:8d26\>\""}], "]"}]}]}], "|>"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.680925774776608*^9, 3.680925802186808*^9}, {
  3.6809262968776083`*^9, 3.680926299186408*^9}, {3.6809264214468794`*^9, 
  3.6809264216028786`*^9}}],

Cell[BoxData["\<\"/***************************************************\\n    \
\:4e1a\:52a1\:7c7b\:578b:\\t\:7ea2\:5229\:5165\:8d26\\n    \:4e1a\:52a1\:6458\
\:8981:\\t221007\\n\\n\\n    \:672c\:5b58\:50a8\:8fc7\:7a0b\:7531\:4ee5\:4e0b\
\:4f1a\:8ba1\:5206\:5f55\:81ea\:52a8\:751f\:6210\:ff1a\\n\\n|----------+------\
----+----------+----------+--------------|\\n| \:4e1a\:52a1\:7c7b\:578b | \
\:501f\:65b9     | \:8d37\:65b9     | \:91d1\:989d     | \:8bf4\:660e         \
|\\n|----------+----------+----------+----------+--------------|\\n| \:7ea2\
\:5229\:5165\:8d26 | \:8d26\:6237\:8d44\:91d1 | \:5229\:606f\:6536\:5165 | \
\:6210\:4ea4\:91d1\:989d | \:5229\:606f\:6536\:5165\:5165\:8d26 \
|\\n|----------+----------+----------+----------+--------------|\\n| \:7ea2\
\:5229\:5165\:8d26 | \:8868\:5916\:5bf9\:62c6 | \:7ea2\:5229\:91d1\:989d | \
\:6210\:4ea4\:91d1\:989d | \:7ea2\:5229\:91d1\:989d\:8bb0\:5f55 \
|\\n|----------+----------+----------+----------+--------------|\\n\\n\\n*/\\\
n\\nif exists (select * from sysobjects where type = 'P' and name = \
'sp_221007')\\n\\tdrop procedure sp_221007\\ngo\\n\\ncreate procedure \
sp_221007(\\n\\t@bizdate int,  \\n\\t@msg varchar(128) = null \
output)\\nas\\nbegin try\\n\\tbegin transaction\\n\\n\\t\\t-- \:66f4\:65b0\
\:6301\:4ed3\:6838\:7b97\:8868\\n\\tmerge into  as sec\\n\\tusing \
(\\n\\t\\tselect serverid, orgid, custid, fundid, market, stkcode,  as \
ltlx\\n\\t\\tfrom \\n\\t\\twhere digestid =  and bizdate = @bizdate\\n\\t) as \
ord\\n\\ton (\\n\\t\\tsec.serverid = ord.serverid and\\n\\t\\tsec.orgid = \
ord.orgid and\\n\\t\\tsec.custid = ord.custid and\\n\\t\\tsec.fundid = \
ord.fundid and\\n\\t\\tsec.market = ord.market and\\n\\t\\tsec.ltlx = \
ord.ltlx and\\n\\t\\tsec.stkcode = ord.stkcode)\\n\\twhen matched \
then\\n\\t\\tupdate set \\n\\twhen not matched then\\n\\t\\tinsert (serverid, \
orgid, custid, fundid, market, stkcode, ltlx)  \\n\\t\\tvalues (ord.serverid, \
ord.orgid, ord.custid, ord.fundid, ord.market, ord.stkcode, \
ord.ltlx);\\n\\n\\t\\n\\n\\tselect \
@msg='\:6838\:7b97\:5904\:7406\:6210\:529f'\\n\\n\\tupdate logasset_hs set \
sett_status = 3, sett_remark = @msg\\n\\twhere  bizdate = @bizdate and \
digestid = 221007 and bizdate = @bizdate\\n\\n\\tcommit \
transaction\\n\\treturn 0\\nend try\\n\\nbegin catch\\n\\tif @@trancount > \
0\\n\\t\\trollback transaction\\n\\t\\n\\treturn -1\\nend \
catch\\n\\ngo\\n\"\>"], "Output",
 CellChangeTimes->{
  3.680925803481608*^9, 3.680925881859008*^9, 3.680925948674808*^9, 
   3.6809263044748077`*^9, {3.6809264108545475`*^9, 3.680926422694872*^9}, 
   3.6809264687466216`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringReplace", "[", 
  RowBox[{"Keys", "@", 
   RowBox[{"First", "@", 
    RowBox[{"KeyIntersection", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\:6838\:7b97\:8bbe\:8ba1", "[", 
        RowBox[{
        "\"\<\:4e1a\:52a1\:6838\:7b97\>\"", ",", 
         "\"\<\:7ea2\:5229\:5165\:8d26\>\""}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Query", "[", 
         RowBox[{"\"\<\:8868\:5b57\:6bb5\:5b9a\:4e49\>\"", ",", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{
            "#\:8868", "\[Equal]", "\"\<\:6301\:4ed3\:6838\:7b97\>\""}], 
            "&"}], "]"}]}], "]"}], "@", "\:6838\:7b97\:8bbe\:8ba1"}]}], "}"}],
      "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6809198608790197`*^9, 3.6809199431599927`*^9}, {
  3.680919977187375*^9, 3.6809199980756407`*^9}, {3.680920142688114*^9, 
  3.6809201935945873`*^9}, {3.6809202492922306`*^9, 3.6809202647985315`*^9}}],

Cell["{\"\:5229\:606f\:6536\:5165\", \"\:7ea2\:5229\:91d1\:989d\"}", "Output",
 CellChangeTimes->{
  3.6809198808499928`*^9, 3.680919944657583*^9, {3.6809199796209593`*^9, 
   3.680919999152034*^9}, {3.6809201591616087`*^9, 3.680920194468182*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"translateDB", "[", 
   RowBox[{"biz_String", "\[Rule]", "params_"}], "]"}], ":=", 
  RowBox[{"biz", "\[Rule]", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Lookup", "[", 
       RowBox[{
        RowBox[{"\:79d1\:76ee\:589e\:51cf", "[", "biz", "]"}], ",", "#", ",", 
        "#"}], "]"}], "&"}], ",", "params"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.680573133983536*^9, 3.680573415762536*^9}, {
  3.6805734732655363`*^9, 3.6805734858575363`*^9}, {3.680573518322536*^9, 
  3.680573551360536*^9}, {3.680573584289536*^9, 3.680573615737536*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Query", "[", 
   RowBox[{
   "\"\<\:516c\:5171\:8fc7\:7a0b\:53c2\:6570\>\"", ",", "All", ",", 
    "\"\<\:8d4b\:503c\>\""}], "]"}], "@", 
  "\:6838\:7b97\:8bbe\:8ba1"}]], "Input",
 CellChangeTimes->{{3.680586729678536*^9, 3.680586785236536*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"@action\"\>", "\[Rule]", "\<\"\"\>"}], ",", 
   RowBox[{"\<\"@matchqty\"\>", 
    "\[Rule]", "\<\"\:6210\:4ea4\:6570\:91cf\"\>"}], ",", 
   RowBox[{"\<\"@matchamt\"\>", 
    "\[Rule]", "\<\"\:6210\:4ea4\:91d1\:989d\"\>"}], ",", 
   RowBox[{"\<\"@matchamt_ex\"\>", "\[Rule]", "\<\"0\"\>"}], ",", 
   RowBox[{"\<\"@aiamount\"\>", "\[Rule]", "\<\"0\"\>"}], ",", 
   RowBox[{"\<\"@fundeffect\"\>", 
    "\[Rule]", "\<\"\:8d26\:6237\:8d44\:91d1\"\>"}], ",", 
   RowBox[{"\<\"@stkeffect\"\>", 
    "\[Rule]", "\<\"\:5e93\:5b58\:6570\:91cf\"\>"}], ",", 
   RowBox[{"\<\"@stkcost_ch\"\>", 
    "\[Rule]", "\<\"\:5e93\:5b58\:6210\:672c\"\>"}], ",", 
   RowBox[{"\<\"@syvalue_ch\"\>", 
    "\[Rule]", "\<\"\:4ea4\:6613\:6536\:76ca\"\>"}], ",", 
   RowBox[{"\<\"@aicost_ch\"\>", 
    "\[Rule]", "\<\"\:5229\:606f\:6210\:672c\"\>"}], ",", 
   RowBox[{"\<\"@lxsr_ch\"\>", 
    "\[Rule]", "\<\"\:5229\:606f\:6536\:5165\"\>"}], ",", 
   RowBox[{"\<\"@fee\"\>", "\[Rule]", "\<\"\:603b\:8d39\:7528\"\>"}], ",", 
   RowBox[{"\<\"@jsxf\"\>", "\[Rule]", "\<\"\:51c0\:624b\:7eed\:8d39\"\>"}], 
   ",", 
   RowBox[{"\<\"@yhs\"\>", "\[Rule]", "\<\"\:5370\:82b1\:7a0e\"\>"}], ",", 
   RowBox[{"\<\"@ghf\"\>", "\[Rule]", "\<\"\:8fc7\:6237\:8d39\"\>"}], ",", 
   RowBox[{"\<\"@qtfee\"\>", "\[Rule]", "\<\"\:5176\:5b83\:8d39\"\>"}], ",", 
   RowBox[{"\<\"@lxs\"\>", "\[Rule]", "\<\"\:5229\:606f\:7a0e\"\>"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.680586707342536*^9, {3.680586743878536*^9, 3.6805867863535357`*^9}}]
}, Open  ]]
}, Closed]]
},
WindowSize->{918, 642},
WindowMargins->{{1, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (2016\:5e743\:670819\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 225, 4, 31, "Input"],
Cell[808, 28, 599, 9, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1444, 42, 158, 2, 70, "Section"],
Cell[1605, 46, 13615, 292, 1237, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15257, 343, 172, 2, 70, "Section"],
Cell[CellGroupData[{
Cell[15454, 349, 2222, 46, 251, "Input"],
Cell[17679, 397, 1676, 34, 244, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19404, 437, 97, 1, 70, "Section"],
Cell[19504, 440, 6720, 144, 513, "Input"],
Cell[26227, 586, 469, 11, 97, "Input"],
Cell[26699, 599, 1972, 40, 120, "Input"],
Cell[28674, 641, 1376, 32, 120, "Input"],
Cell[CellGroupData[{
Cell[30075, 677, 1001, 24, 55, "Input"],
Cell[31079, 703, 325, 5, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31441, 713, 169, 4, 33, "Input"],
Cell[31613, 719, 528, 11, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32178, 735, 1283, 29, 136, "Input"],
Cell[33464, 766, 2614, 37, 1412, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[36115, 808, 969, 23, 49, "Input"],
Cell[37087, 833, 247, 3, 31, "Output"]
}, Open  ]],
Cell[37349, 839, 603, 14, 33, "Input"],
Cell[CellGroupData[{
Cell[37977, 857, 280, 7, 33, "Input"],
Cell[38260, 866, 1588, 31, 96, "Output"]
}, Open  ]]
}, Closed]]
}
]
*)

